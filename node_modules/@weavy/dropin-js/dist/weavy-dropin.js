!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Weavy=t():e.Weavy=t()}(self,(()=>(()=>{"use strict";var e={307:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(81),r=n.n(o),i=n(645),a=n.n(i)()(r());a.push([e.id,"@supports(display: contents){weavy,weavy-root{display:contents}}@supports not (display: contents){weavy,weavy-root{display:flex;position:absolute;top:0;left:0;right:0;bottom:0;pointer-events:none}}",""]);const s=a.toString()},136:(e,t,n)=>{n.d(t,{Z:()=>p});var o=n(81),r=n.n(o),i=n(645),a=n.n(i),s=n(667),l=n.n(s),c=new URL(n(6),n.b),d=a()(r()),u=l()(c);d.push([e.id,'[class^=wy-],[class^=wy-]::before,[class^=wy-]::after,[class^=wy-] *,[class^=wy-] *::before,[class^=wy-] *::after,[class*=" wy-"],[class*=" wy-"]::before,[class*=" wy-"]::after,[class*=" wy-"] *,[class*=" wy-"] *::before,[class*=" wy-"] *::after{box-sizing:border-box}[class^=wy-][hidden],[class^=wy-] *[hidden],[class*=" wy-"][hidden],[class*=" wy-"] *[hidden]{display:none !important}[class^=wy-][role=button],[class^=wy-] *[role=button],[class*=" wy-"][role=button],[class*=" wy-"] *[role=button]{cursor:pointer}[class^=wy-] a[class^=wy-],[class^=wy-] a[class*=" wy-"],[class^=wy-] a,[class*=" wy-"] a[class^=wy-],[class*=" wy-"] a[class*=" wy-"],[class*=" wy-"] a{text-decoration:none}[class^=wy-] a[class^=wy-]:not([href]):not([class]),[class^=wy-] a[class^=wy-]:not([href]):not([class]):hover,[class^=wy-] a[class*=" wy-"]:not([href]):not([class]),[class^=wy-] a[class*=" wy-"]:not([href]):not([class]):hover,[class^=wy-] a:not([href]):not([class]),[class^=wy-] a:not([href]):not([class]):hover,[class*=" wy-"] a[class^=wy-]:not([href]):not([class]),[class*=" wy-"] a[class^=wy-]:not([href]):not([class]):hover,[class*=" wy-"] a[class*=" wy-"]:not([href]):not([class]),[class*=" wy-"] a[class*=" wy-"]:not([href]):not([class]):hover,[class*=" wy-"] a:not([href]):not([class]),[class*=" wy-"] a:not([href]):not([class]):hover{text-decoration:none}[class^=wy-] p[class^=wy-],[class^=wy-] p[class*=" wy-"],[class^=wy-] p,[class*=" wy-"] p[class^=wy-],[class*=" wy-"] p[class*=" wy-"],[class*=" wy-"] p{margin-top:0;margin-bottom:1rem}.wy-alert-message{padding:.25rem .5rem;background-color:#a6daf2;text-align:center;width:24rem;color:#125b7d;border-radius:.1875rem;margin:0 auto;margin-top:1rem;font-family:var(--wy-font-sans-serif);position:relative;z-index:10;box-shadow:0 .5rem .625rem .0625rem rgba(0,0,0,.14),0 .1875rem 1.25rem .125rem rgba(0,0,0,.12),0 .3125rem .3125rem -0.1875rem rgba(0,0,0,.2);max-width:calc(100% - 3rem);pointer-events:none;user-select:none}.wy-alert-message a{color:#0b3a50;text-decoration:none;font-weight:700;pointer-events:auto}.wy-alert-message.wy-fade{transition:all .2s cubic-bezier(0.4, 0, 0.2, 1);opacity:0;height:0;padding-top:0;padding-bottom:0;margin-top:0}.wy-alert-message.wy-fade.wy-in{transition:opacity .2s cubic-bezier(0.4, 0, 0.2, 1);opacity:1;height:auto;padding-top:.5rem;padding-bottom:.5rem;margin-top:1rem}.wy-alert-message .wy-button{cursor:pointer;display:inline-flex;flex-shrink:0;flex-grow:0;font-weight:400;text-align:center;white-space:nowrap;vertical-align:middle;user-select:none;border:1px solid rgba(0,0,0,0);padding:.3125rem .75rem;font-size:1rem;line-height:1.5;border-radius:.1875rem;color:#fff;background-color:#156b93;border-color:#156b93;box-shadow:unset;margin-top:.5rem}.wy-alert-message .wy-button>*{display:inline-flex}.wy-filebrowser{pointer-events:none;width:auto;left:0;top:0;right:0;bottom:0;max-width:none;display:flex;align-items:center;justify-content:center}.wy-filebrowser-frame{pointer-events:all;display:none;width:100%;height:100%;z-index:99999999;position:absolute;top:0;left:0;border:0;background:rgba(0,0,0,.5)}.wy-icon{display:inline-flex;align-items:center;justify-content:center;flex:0 0 auto;position:relative}.wy-icon:not([width]){width:1.5rem}.wy-icon:not([height]){height:1.5rem}.wy-icon-overlay{position:absolute;bottom:0;right:0;background:var(--wy-white);border-radius:50%;border:1px solid var(--wy-white)}.wy-icon-stack{display:inline-block;position:relative;line-height:1;width:1.5rem;height:1.5rem}.wy-icon-stack .wy-icon:first-child{width:100%;height:100%}.wy-icon-stack .wy-icon:last-child{position:absolute;bottom:0;right:0;width:50%;height:50%;background-color:var(--wy-body-bg);border-radius:50%}.wy-icon:not([class*=wy-icon-]) *{fill:currentColor}.wy-icon-primary *{fill:var(--wy-primary)}.wy-icon-secondary *{fill:var(--wy-secondary)}.wy-icon-success *{fill:var(--wy-success)}.wy-icon-info *{fill:var(--wy-info)}.wy-icon-warning *{fill:var(--wy-warning)}.wy-icon-danger *{fill:var(--wy-danger)}.wy-icon-light *{fill:var(--wy-light)}.wy-icon-dark *{fill:var(--wy-dark)}.wy-viewport{position:fixed;top:0;right:0;bottom:0;left:0;z-index:2147483647;pointer-events:none}.wy-overlays{pointer-events:none;width:auto;left:0;top:0;right:0;bottom:0;max-width:none;display:flex;align-items:center;justify-content:center;transform-style:preserve-3d;overflow-y:initial;overflow-x:initial;perspective:100rem;perspective-origin:center center}.wy-overlays .wy-panel{background-color:rgba(255,255,255,.95)}.wy-overlays .wy-panel:not(.wy-transition){transform:translateZ(-4rem) !important}.wy-overlays .wy-panel .wy-controls{position:absolute;border-bottom:none;flex-direction:row;transition:opacity .1s .2s step-end}.wy-overlays .wy-panel .wy-controls .wy-icon{color:rgba(0,0,0,.54)}.wy-overlays .wy-panel.wy-loaded .wy-controls{pointer-events:none;opacity:0}.wy-overlays .wy-panel .wy-panel-frame{background-color:rgba(0,0,0,0)}.wy-overlays .wy-panel.wy-controls-light .wy-icon{color:rgba(0,0,0,.54)}.wy-overlays .wy-panel.wy-light{background-color:rgba(255,255,255,.95)}.wy-overlays .wy-panel.wy-light .wy-icon{color:rgba(0,0,0,.54)}.wy-overlays .wy-panel.wy-controls-dark .wy-icon{color:rgba(255,255,255,.62)}.wy-overlays .wy-panel.wy-controls-dark .wy-icon:hover,.wy-overlays .wy-panel.wy-controls-dark .wy-icon:focus{color:rgba(255,255,255,.95)}.wy-overlays .wy-panel.wy-controls-dark .wy-icon:active{color:#fff}.wy-overlays .wy-panel.wy-dark{background-color:rgba(21,21,21,.95)}.wy-overlays .wy-panel.wy-dark .wy-icon{color:rgba(255,255,255,.62)}.wy-overlays .wy-panel.wy-dark .wy-icon:hover,.wy-overlays .wy-panel.wy-dark .wy-icon:focus{color:rgba(255,255,255,.95)}.wy-overlays .wy-panel.wy-dark .wy-icon:active{color:#fff}.wy-overlays .wy-panel.wy-dark.wy-open[data-title]::before{background-color:rgba(41,41,41,.95);color:rgba(255,255,255,.62);box-shadow:rgba(71,71,71,.95) 0px -1px 0px 0px inset}@media(min-width: 768px){.wy-overlays .wy-panel.wy-floating{left:1rem;top:1rem;right:1rem;bottom:1rem;border-radius:.1875rem;box-shadow:0 1rem 2.25rem .125rem rgba(0,0,0,.14),0 .375rem 1.875rem .3125rem rgba(0,0,0,.12),0 .5rem .625rem -0.3125rem rgba(0,0,0,.2)}.wy-overlays .wy-panel.wy-floating:not(.wy-scroll-y){overflow:hidden}}.wy-overlays .wy-panel.wy-modal{background-color:rgba(255,255,255,.95)}@media(min-width: 768px){.wy-overlays .wy-panel.wy-modal{left:auto;right:auto;top:2rem;bottom:3.2rem;margin-left:4rem;margin-top:auto;margin-right:4rem;margin-bottom:auto;border-radius:.25rem;box-shadow:0 1rem 2.25rem .125rem rgba(0,0,0,.14),0 .375rem 1.875rem .3125rem rgba(0,0,0,.12),0 .5rem .625rem -0.3125rem rgba(0,0,0,.2);width:32rem;max-height:32rem}.wy-overlays .wy-panel.wy-modal:not(.wy-scroll-y){overflow:hidden}}.wy-overlays .wy-panel.wy-loading .wy-controls{transition:opacity .2s cubic-bezier(0.4, 0, 0.2, 1);opacity:1}.wy-panels{position:absolute;top:0;right:0;bottom:0;left:0;overscroll-behavior:contain;overflow-y:auto;overflow-x:hidden}.wy-panel{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;overflow:hidden;background-color:rgba(255,255,255,.95);display:flex;flex-direction:column}.wy-panel .wy-controls{top:.75rem;left:.75rem;min-width:2rem;width:auto;display:flex;z-index:10000;order:-1;flex-direction:row-reverse;border-bottom:1px solid #ccc}.wy-panel .wy-controls:empty{display:none}.wy-panel .wy-controls .wy-icon{color:rgba(0,0,0,.54)}.wy-panel .wy-panel-frame{transition:opacity .1s .2s cubic-bezier(0.4, 0, 0.2, 1);opacity:1}.wy-panel:not(.wy-loaded) .wy-panel-frame{opacity:0;transition:opacity .2s .1s step-start}.wy-panel.wy-open{pointer-events:all;z-index:5}.wy-panel.wy-open[data-title]::before{content:attr(data-title);position:absolute;top:0;left:0;right:0;height:3rem;padding:.5rem .5rem;opacity:0;pointer-events:none;display:flex;align-items:center;justify-content:center;transition:opacity .1s .2s step-end;font-family:var(--wy-font-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica Neue, Noto Sans, Liberation Sans, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji);line-height:1.5;font-weight:400;background-color:rgba(242,242,242,.95);color:rgba(0,0,0,.69);box-shadow:rgba(204,204,204,.95) 0px -1px 0px 0px inset;backface-visibility:hidden}@supports(backdrop-filter: blur(0.5rem)){.wy-panel.wy-open[data-title]::before{backdrop-filter:blur(0.5rem)}}.wy-panel.wy-open::after{content:"";position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;opacity:0;transition:opacity .2s cubic-bezier(0.4, 0, 0.2, 1) 0s}.wy-panel.wy-open.wy-loading[data-title]::before{transition:opacity .2s cubic-bezier(0.4, 0, 0.2, 1);opacity:1}.wy-panel.wy-open.wy-loading::after{transition:opacity .2s cubic-bezier(0.4, 0, 0.2, 1) .5s;opacity:1;background-image:url('+u+');background-repeat:no-repeat;background-position:50%;background-size:rem(2);background-color:rgba(0,0,0,0)}.wy-panel{opacity:0;visibility:hidden;transition:opacity .1s cubic-bezier(0.4, 0, 0.2, 1) .01s,transform .1s cubic-bezier(0.4, 0, 0.2, 1) .01s,visibility .01s step-end .1s}.wy-panel.wy-open{transition:opacity .2s cubic-bezier(0.4, 0, 0.2, 1),transform .2s cubic-bezier(0.4, 0, 0.2, 1),visibility .2s step-start;visibility:visible}.wy-panel.wy-open.wy-transition{opacity:1;transform:none}.wy-panel-frame{flex:1 1 100%;border:0}.wy-container{position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;font-size:rem(1);line-height:rem(1.5);position:relative;display:flex;flex-direction:column;align-self:stretch;flex:1 1 100%;height:100%;align-items:flex-start;justify-content:flex-start}.wy-container.wy-viewport{position:fixed;z-index:2147483647}.wy-container:not(.wy-viewport)>*{pointer-events:auto}.wy-container iframe{border:none}.wy-container[data-weavy-error]::after{content:"🤷 " attr(data-weavy-error);position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;pointer-events:none;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";display:flex;align-items:center;justify-content:center;background:#fff;color:#333}',""]);const p=d.toString()},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);o&&a[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},667:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},81:e=>{e.exports=function(e){return e[1]}},6:e=>{e.exports="data:image/svg+xml,%3Csvg viewBox=%270 0 24 24%27 width=%2724%27 height=%2724%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:xlink=%27http://www.w3.org/1999/xlink%27%3E%3Cstyle type=%27text/css%27%3Eg%7Banimation:rotate 2s linear infinite;transform-origin:center center%7Dcircle%7Bstroke-dasharray:1,100;stroke-dashoffset:0;animation:dash 1.5s ease-in-out infinite,color 6s ease-in-out infinite%7D@keyframes rotate%7B100%25%7Btransform:rotate%28360deg%29%7D%7D@keyframes dash%7B0%25%7Bstroke-dasharray:1,100;stroke-dashoffset:0%7D50%25%7Bstroke-dasharray:44.5,100;stroke-dashoffset:-17.5px%7D100%25%7Bstroke-dasharray:44.5,100;stroke-dashoffset:-62px%7D%7D@keyframes color%7B0%25,100%25%7Bstroke:%23216eb4%7D40%25%7Bstroke:%2328b7cf%7D66%25%7Bstroke:%23216eb4%7D80%25,90%25%7Bstroke:%2328b7cf%7D%7D%3C/style%3E%3Cg%3E%3Ccircle fill=%27none%27 cx=%2712%27 cy=%2712%27 r=%2711%27 stroke-linecap=%27butt%27 stroke-width=%272%27 /%3E%3C/g%3E%3C/svg%3E"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={id:o,exports:{}};return e[o](i,i.exports,n),i.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.b=document.baseURI||self.location.href;var o={};return(()=>{function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function t(e){return"[object Object]"===Object.prototype.toString.call(e)}function r(e){var n,o;return!1!==t(e)&&(void 0===(n=e.constructor)||!1!==t(o=n.prototype)&&!1!==Object.prototype.hasOwnProperty.call(o,"isPrototypeOf"))}function i(e,t,n){var o;e=e||{},t=t||{};var a={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&(a[o]=e[o]);for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n&&a[o]&&r(a[o])&&r(t[o])?a[o]=i(a[o],t[o],n):a[o]=t[o]);return a}function a(e){return e&&(Array.isArray(e)?e:[e])||[]}function s(e){if(e){if(e instanceof HTMLElement)return e;if("string"==typeof e)return 0===e.indexOf("<")?function(e){if("content"in document.createElement("template")){var t=document.createElement("template");return t.innerHTML=e.trim(),t.content.children}var n=document.implementation.createHTMLDocument();return n.body.innerHTML=e.trim(),n.body.children}(e)[0]:document.querySelector(e);if((t=e)&&t.jquery&&t.length)return console.warn("Weavy: providing jQuery elements is deprecated, please provide a HTMLElement or selector query instead."),e[0]}var t}function l(e,t,n){return(n||"string"==typeof e&&"string"==typeof t)&&String(e).toUpperCase()===String(t).toUpperCase()}function c(e,t){return e&&t&&e.jquery&&t.jquery&&e.jquery===t.jquery&&e.length===t.length&&e.length===e.filter(t).length}function d(e,t,n){if(!r(e)||!r(t))return!1;var o=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);if(!n&&o.length!==i.length)return!1;for(var a=0;a<o.length;a++){var s=o[a],l=e[s],u=t[s];if(l!==u&&!c(l,u)&&!d(l,u,n))return!1}return!0}function u(e,t){if(!(t instanceof HTMLElement||t instanceof Node))return t}function p(e,t){if(r(e)){const n={};return Object.keys(e).forEach((function(o){n[function(e,t){return(e=t?e[0].toUpperCase()+e.substring(1):e[0].toLowerCase()+e.substring(1)).replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))}(o,t)]=p(e[o],t)})),n}return Array.isArray(e)?e.map((function(e){return p(e,t)})):e}function f(e){if(e){let t=(e.headers.has("content-type")?e.headers.get("content-type"):"").split(";")[0];if(e.ok){if("application/json"===t)try{return e.json().then((function(e){return p(e)})).catch((function(){return null}))}catch(e){return null}return e}if(t.match(/json$/i))try{return e.json().then((function(e){return p(e)})).then((function(t){return Promise.reject(new Error(t.detail||t.title||t.message||e.statusText||t.status))}),(function(){return Promise.reject(new Error(e.statusText))}))}catch(e){}return Promise.reject(new Error(e.statusText))}}n.d(o,{default:()=>_});new Map;const h=function(e){var t=this,n=[];function o(e,t,o,r,i,a){n.push({context:e,events:t,selector:o,handler:r,originalHandler:i,external:a})}function i(e,t,o,r,i,a){var s={context:e,events:t,selector:o,handler:r,originalHandler:i,external:a},l=n.filter((function(e){return d(s,e,!0)})).pop();return l&&l.handler}function a(e,t,o,r,i,a){var s={context:e,events:t,selector:o,handler:r,originalHandler:i,external:a},l=!1;return n.forEach((function(e,t){d(s,e,!0)&&(l=!0,n.splice(t,1))})),l}function l(e,t,o){var r=new CustomEvent(t,{cancelable:!0}),i=!1;return n.forEach((function(n){n.external||n.context!==e||n.events.split(" ").forEach((function(e){if(e=0===e.indexOf("on:")?e.split("on:")[1]:e,t===e&&(!n.selector||d(n.selector,o,!0))){var a=n.handler(r,o);a?o=a:!1===a&&(i=!0)}}))})),!(i||r.cancelBubble||r.defaultPrevented)&&o}function c(n,o){var r,i,a,l,c="string"==typeof o[0]&&o[0];return c?(l="function"==typeof o[1]?o[1]:o[2],a="function"==typeof o[1]?null:o[1],i=o[0],r=t===n?e:n):(l="function"==typeof o[2]?o[2]:o[3],a="function"==typeof o[2]?null:o[2],i=o[1],r=function(t){if(t){if(t.on&&"function"==typeof t.on)return t;var n=s(t);if(n)return n;if(t instanceof EventTarget)return t}return e}(r=o[0])),{context:r,events:i,selector:a,handler:l,external:!c}}this.on=function(e,t,n,i){var s=Array.from(arguments||[]),l=c(this,s),d=s[4];if(d){var u=function(){var e=Array.from(arguments||[]);try{l.handler.apply(this,e)}catch(e){try{l.handler()}catch(e){console.warn("Could not invoke one handler:",e)}}a(l.context,l.events,l.selector,null,l.handler,l.external)};o(l.context,l.events,l.selector,u,l.handler,l.external),l.external&&("string"==typeof l.selector||r(l.selector)?"function"==typeof l.context.one?l.context.one(l.events,l.selector,u):console.warn("external .one() target does not support selectors"):"function"==typeof l.context.one?l.context.one(l.events,u):l.context instanceof EventTarget?l.events.split(" ").forEach((function(e){l.context.addEventListener(e,u,{once:!0})})):console.warn("external target does not have valid event listening"))}else o(l.context,l.events,l.selector,l.handler,l.handler,l.external),l.external&&("string"==typeof l.selector||r(l.selector)?"function"==typeof l.context.one?l.context.on(l.events,l.selector,l.handler):console.warn("external .on() target does not support selectors"):"function"==typeof l.context.on?l.context.on(l.events,l.handler):l.context instanceof EventTarget?l.events.split(" ").forEach((function(e){l.context.addEventListener(e,l.handler)})):console.warn("external target does not have valid event listening"))},this.one=function(e,t,n,o){this.on.call(this,e,t,n,o,!0)},this.off=function(e,t,n,o){var s=c(this,Array.from(arguments||[])),l=i(s.events,s.handler,s.context,s.selector),d=a(s.context,s.events,s.selector,l,s.handler,s.external);d&&l?s.external&&s.context&&("string"==typeof s.selector||r(s.selector)?"function"==typeof s.context.off?s.context.off(s.events,s.selector,l):console.warn("external target does not have valid event listening"):"function"==typeof s.context.off?s.context.off(s.events,l):s.context instanceof EventTarget?s.events.split(" ").forEach((function(e){s.context.removeEventListener(e,l)})):console.warn("external target does not have valid event listening")):console.debug("event off: handler not found or already removed;",s.events)},this.clear=function(){n.forEach((function(e){e.external&&e.context&&("string"==typeof e.selector||r(e.selector)?"function"==typeof e.context.off?e.context.off(e.events,e.selector,e.handler):console.warn("external target does not have valid event listening"):"function"==typeof e.context.off?e.context.off(e.events,e.handler):e.context instanceof EventTarget?e.events.split(" ").forEach((function(t){e.context.removeEventListener(t,e.handler)})):console.warn("external target does not have valid event listening"))})),n.length=0},this.triggerEvent=function(t,n){var o=-1!==t.indexOf(":"),r=t.split(":")[0],i=function(e,t){for(var n=[],o=e;o!==t&&o.eventParent;)n.push(o),o=o.eventParent;return o===t?(n.push(t),n):[e,t]}(this,e),a=i.slice().reverse();this instanceof HTMLElement&&this.isConnected&&console.warn("Triggering event on DOM Node may cause unexpected bubbling:",'"'+t+'"',"<"+this.nodeName.toLowerCase()+(this.id?' id="'+this.id+'" />':" />"));var s,c,d="before:"+(t=t.replace("on:","")),u=t,p="after:"+t;if(n&&"string"==typeof n)try{n=JSON.parse(n)}catch(e){console.warn("Could not parse event data")}if(o){var f="before"===r||"after"===r?a:i;for(c=0;c<f.length;c++)if(!1===(n=(s=l(f[c],u,n))||!1===s?s:n))return n}else{for(c=0;c<a.length;c++)if(!1===(n=(s=l(a[c],d,n))||!1===s?s:n))return n;for(c=0;c<i.length;c++)if(!1===(n=(s=l(i[c],u,n))||!1===s?s:n))return n;for(c=0;c<a.length;c++)n=(s=l(a[c],p,n))||!1===s?s:n}return n}},g=["#36ace2","#6599eb","#646fed","#773bde","#bc4bce","#d54487","#de4b3b","#e17637","#e3a135","#c9a018","#a4c51b","#cbbc15","#7cd345","#53c657","#45d391","#38dde0"],y="#8c8c8c";function w(e,t,n){return t?n?Function.prototype.bind.call(e,console,"%c%s","color: "+n,t):Function.prototype.bind.call(e,console,"%c%s","color: "+y,t):Function.prototype.bind.call(e,console,"%cWeavy","color: "+y)}var v=function(e,t){if(!e)throw new Error("No context defined.");e instanceof URL&&(e=e.pathname.split("/").pop()||e.pathname||e.origin||e.hostname);var n=self.name?self.name+":":"",o=e.type||e.constructor&&e.constructor.name||"",r=e&&e.name?(o?".":"")+e.name:e.id?"#"+e.id:"",i="string"==typeof e?n+e:n+o+r,a=v.defaults,s=Array.from(n).reduce((function(e,t){return e+t.charCodeAt(0)}),0)%g.length,l=g[s],c=y,d=function(){};Object.defineProperty(this,"options",{get:function(){return a},set:function(e){a=Object.assign({},v.defaults,a,e),c=!0===a?l:!1===a.color?y:"string"==typeof a.color?a.color:l;let t=!0===a||a.log,n=!0===a||a.info,o=!0===a||a.warn,r=!0===a||a.error;this.log=t?w(window.console.log,i,c):d,this.debug=t?w(window.console.debug,i,c):d,this.info=n?w(window.console.info,i,c):d,this.warn=o?w(window.console.warn,i,c):d,this.error=r?w(window.console.error,i,c):d,this.assert=r?Function.prototype.bind.call(console.assert,console):d,this.count=t?Function.prototype.bind.call(console.count,console):d,this.countReset=t?Function.prototype.bind.call(console.countReset,console):d,this.dir=t?Function.prototype.bind.call(console.dir,console):d,this.dirxml=t?Function.prototype.bind.call(console.dirxml,console):d,this.table=t?Function.prototype.bind.call(console.table,console):d,this.time=t?Function.prototype.bind.call(console.time,console):d,this.timeEnd=t?Function.prototype.bind.call(console.timeEnd,console):d,this.timeLog=t?Function.prototype.bind.call(console.timeLog,console):d,this.trace=t?Function.prototype.bind.call(console.trace,console):d,this.clear=Function.prototype.bind.call(console.clear,console),this.group=Function.prototype.bind.call(console.group,console),this.groupCollapsed=Function.prototype.bind.call(console.groupCollapsed,console),this.groupEnd=Function.prototype.bind.call(console.groupEnd,console)}}),this.options=t};v.defaults={color:!0,log:!1,info:!0,warn:!0,error:!0};const m=v;window.addEventListener("unhandledrejection",(function(e){e.promise.weavy&&e.preventDefault()}));var b=function(e){var t,n="pending",o=function(){return t};return o.promise=o.bind(o),o.state=function(){return n},(o.reset=function(){var r,i;return n="pending",t=new Promise((function(e,t){r=function(){n="resolved",e.apply(this,arguments)},i=function(){n="rejected",t.apply(this,arguments)}})),t.weavy=!0,o.resolve=function(){return r.apply(t,arguments),o},o.reject=function(){return i.apply(t,arguments),o},"function"==typeof e&&e(r,i),o})(),o.then=function(){return(t=t.then.apply(t,arguments)).weavy=!0,o},o.catch=function(){return(t=t.catch.apply(t,arguments)).weavy=!0,o},o.finally=function(){return(t=t.finally.apply(t,arguments)).weavy=!0,o},o};b.resolve=function(e){var t=b();return t.resolve(e),t},b.reject=function(e){var t=b();return t.reject(e),t};const S=b;const I=new function(t){var n=new m("WeavyPostal"),o=this;this.timeout=t&&t.timeout||2e3;var i=[],a=[],s=new Set,l=new Map,c=new WeakMap,u=new WeakMap,p=new WeakMap,f=new WeakMap,h=new S,g=null,y=w(window.location.href);function w(e){var t=null;try{t=/^((?:https?:\/\/[^/]+)|(?:file:\/\/))\/?/.exec(e)[1]}catch(e){n.error("Unable to resolve location origin. Make sure you are using http, https or file protocol and have a valid location URL.")}return t}function v(e,t){var n=e.source===window&&e.origin===y;if(t||=c.has(e.source)&&e.origin===c.get(e.source),n||t){var o=!e.data.weavyId||!0===e.data.weavyId;t&&!e.data.windowName&&(e.data.windowName=u.get(e.source));var i=e.data.name;if("distribute"===i){if(g)return;e.data.name=e.data.distributeName}a.forEach((function(t){var n=t.name===i||"message"===t.name,a=null===t.selector,s=t.selector===e.data.weavyId,l=r(t.selector)&&d(t.selector,e.data,!0);n&&(o||a||s||l)&&(t.handler(e,e.data),t.once&&I(t.name,t.selector,t.handler))}))}}function b(e,t,n){"function"==typeof arguments[1]&&(n=arguments[1],t=null),a.push({name:e,handler:n,selector:t})}function I(e,t,n){"function"==typeof arguments[1]&&(n=arguments[1],t=null),a=a.filter((function(o){var i=e===o.name,a=n===o.handler,s="string"==typeof t&&t===o.selector,l=r(t)&&d(t,o.selector);return!(i&&a&&(null===t||s||l))}))}function x(e,t){if(l.has(t)){if(l.get(t).has(e)){var n=l.get(t).get(e);try{s.delete(n),u.delete(n),p.delete(n),c.delete(n)}catch(e){}}if(l.get(t).delete(e),0===l.get(t).size)try{l.delete(t)}catch(e){}}}function E(t,r,i){var a=new S;null===i&&(i=void 0);var s=t===window.self,l=s?w(window.location.href):c.get(t);return s||t&&l===f.get(t)?(r.weavyMessageId||(r.weavyMessageId=e()+e()),queueMicrotask((()=>{n.debug("whenPostMessage",r.name,r.weavyMessageId);var e=setTimeout((function(){"pending"===a.state()&&a.reject(new Error("postMessage() receipt timed out: "+r.weavyMessageId+", "+r.name))}),o.timeout||2e3);b("message-receipt",{weavyId:r.weavyId,weavyMessageId:r.weavyMessageId},(function(){n.debug("message-receipt received",r.weavyMessageId,r.name),clearTimeout(e),a.resolve()}));try{t.postMessage(r,l,i)}catch(e){a.reject(e)}}))):a.reject(new Error("postMessage() Invalid window origin: "+l+", "+r.name)),a()}window.addEventListener("message",(function(e){if(e.data.name&&void 0!==e.data.weavyId){if(e.data.weavyMessageId&&"message-receipt"!==e.data.name&&"unready"!==e.data.name){n.debug("sending message receipt",e.data.weavyMessageId,e.data.name);try{e.source.postMessage({name:"message-receipt",weavyId:e.data.weavyId,weavyMessageId:e.data.weavyMessageId},e.origin)}catch(e){n.error("could not post back message-receipt to source")}}switch(e.data.name){case"register-child":if(p.has(e.source)||n.warn("register-child: contentwindow not pre-registered"),c.get(e.source)!==e.origin)return void n.error("register-child: "+u.get(e.source)+" has invalid origin",e.origin);try{var t=p.get(e.source),o=u.get(e.source);o&&e.source.postMessage({name:"register-window",windowName:o,weavyId:t||!0},e.origin)}catch(e){n.error("could not register frame window",t,o,e)}break;case"ready":l.has(e.data.weavyId)&&u.has(e.source)&&l.get(e.data.weavyId).get(u.get(e.source))&&(f.set(e.source,e.origin),v(e));break;case"unready":l.has(e.data.weavyId)&&v(e,!0);break;default:e.source===window||l.size?v(e):i.push(e)}}})),this.on=b,this.one=function(e,t,n){"function"==typeof arguments[1]&&(n=arguments[1],t=null),a.push({name:e,handler:n,selector:t,once:!0})},this.off=I,this.registerContentWindow=function(e,t,o,r){try{if(!t)return void n.error("registerContentWindow() No valid contentWindow to register, must be a window and have a name.")}catch(e){n.error("registerContentWindow() cannot access contentWindowName")}e.self&&(e=e.self),o&&"true"!==o||(o=!0),l.has(o)||l.set(o,new Map),l.get(o).set(t,e),s.add(e),u.set(e,t),p.set(e,o),c.set(e,r)},this.unregisterContentWindow=x,this.unregisterAll=function(e){l.has(e)&&(l.get(e).forEach((function(t,n){x(n,e)})),l.get(e),l.delete(e))},this.postToFrame=function(e,t,o,r){if("object"==typeof o&&o.name){var i;try{i=l.get(t).get(e)}catch(o){n.error("postToFrame() Window not registered",t,e)}return o.weavyId=t,E(i,o,r)}n.error("postToFrame() Invalid message format",o)},this.postToSelf=function(e,t){if("object"==typeof e&&e.name)return e.weavyId=e.weavyId||!0,E(window.self,e,t);n.error("postToSelf() Invalid message format",e)},this.postToSource=function(e,t,o){if(e.source&&void 0!==e.data.weavyId){var r=e.source===window.self&&e.origin===y,i=c.has(e.source)&&e.origin===c.get(e.source);if(null===o&&(o=void 0),r||i){t.weavyId=e.data.weavyId;try{e.source.postMessage(t,e.origin,o)}catch(e){n.error("postToSource() Could not post message back to source")}}}},this.postToChildren=function(e,t){"object"==typeof e&&e.name?(null===t&&(t=void 0),e.distributeName=e.name,e.name="distribute",e.weavyId=e.weavyId||!0,s.forEach((function(o){if(c.get(o)===f.get(o))try{o.postMessage(e,c.get(o),t)}catch(e){n.warn("postToChildren() could not distribute message to "+u.get(o))}}))):n.error("postToChildren() Invalid message format",e)},this.whenLeader=function(){return h()},Object.defineProperty(this,"isLeader",{get:function(){return g}}),"pending"===h.state()&&(n.debug("Is leader"),g=!0,h.resolve(g))};var x=n(307),E=n(136);class k{static supportsShadowDOM=!!HTMLElement.prototype.attachShadow;static supportsConstructableStylesheets="adoptedStyleSheets"in document;static globalStyleSheet;static commonStyleSheet;static addStyleSheet(e,t){if(e&&t){if(k.supportsConstructableStylesheets){let n=new CSSStyleSheet;return n.replaceSync(e),t.adoptedStyleSheets=Array.prototype.concat.call(t.adoptedStyleSheets,[n]),n}{let n=document.createElement("style");return n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),(t===document?document.head:t).appendChild(n),n}}}id;#e;parent;section;root;dom;container;#t;#n;#o;#r;#i;static registerCustomElements(){if(!k.globalStyleSheet){if("customElements"in window)try{window.customElements.define("weavy-root",HTMLElement.prototype),window.customElements.define("weavy-container",HTMLElement.prototype)}catch(e){}k.globalStyleSheet=k.addStyleSheet(x.Z,document)}}constructor(e,t,n,o){if(this.#t=e,this.#e=e.removeId(n),this.id=e.getId(n),this.parent=s(t),!this.parent)throw new Error("No parent container defined"+this.id);this.eventParent=o,this.on=e.events.on.bind(this),this.one=e.events.one.bind(this),this.off=e.events.off.bind(this),this.triggerEvent=e.events.triggerEvent.bind(this),k.registerCustomElements(),this.section=document.createElement("weavy"),this.section.id=this.id,this.root=document.createElement("weavy-root"),this.root.setAttribute("data-version",e.version),this.container=document.createElement("weavy-container"),this.container.className="wy-container",this.container.id=e.getId("container-"+this.#e),this.#o=[],this.#r=[],this.#i="",this.triggerEvent("before:root-create",this),this.parent.appendChild(this.section),this.section.appendChild(this.root),k.supportsShadowDOM?("open"===e.options.shadowMode&&e.warn(this.id,"Using ShadowDOM in open mode",this.id),this.dom=this.root.attachShadow({mode:e.options.shadowMode||"closed"})):this.dom=this.root,this.dom.appendChild(this.container),e.options.includeStyles&&this.#a(),this.#s(),this.addStyles(e.options),this.triggerEvent("on:root-create",this),queueMicrotask((()=>this.triggerEvent("after:root-create",this)))}#a(){k.supportsShadowDOM?k.addStyleSheet(E.Z,this.dom):k.commonStyleSheet||(k.commonStyleSheet=k.addStyleSheet(E.Z,document))}#s(){if(!this.#n){this.#n="";for(let e of document.styleSheets)try{if(e instanceof CSSStyleSheet&&e.cssRules)for(let t of e.cssRules)t.cssText.includes(".wy-")&&!t.parentRule&&(this.#t.debug("Found external rule",t.cssText),this.#n+=t.cssText+"\n")}catch(t){this.#r.push({name:e.href||e.ownerNode.nodeName,error:t.toString()})}}k.supportsShadowDOM&&k.addStyleSheet(this.#n,this.dom)}addStyles(e){if(e?.css&&(this.#t.debug(this.id,"CSS: adding custom css"),this.#i+=e.css),e?.stylesheet){a(e.stylesheet).forEach((e=>{var t=new URL(e,window.location.href),n=new S;if(!this.#o.find((e=>e.url?.toString()===t.toString()))){let e={url:t,whenCss:n,css:""};this.#o.push(e),this.#t.debug(this.id,"CSS: fetching stylesheet",t.toString()),fetch(t).then((t=>{let o=(t.headers.has("content-type")?t.headers.get("content-type"):"").split(";")[0];return t.ok&&"text/css"===o?t.text().then((t=>{e.css=t,n.resolve()})):Promise.reject(new Error("Error fetching stylesheet"))})).catch((e=>{this.#r.push({name:t,error:e.toString()}),n.reject(e)}))}}))}return this.#l(),Promise.allSettled(this.#o.map((e=>e.whenCss))).then((e=>(this.#c(this.id,"Some stylesheets could not be fetched"),e.filter((e=>"fulfilled"===e.status)).map((e=>e.value)))))}#l(){this.triggerEvent("before:root-styles"),!!this.#o.find((e=>"pending"===e.whenCss?.state()))?Promise.allSettled(this.#o.map((e=>e.whenCss))).then((()=>{this.#l()})):(this.#o.forEach((e=>{k.addStyleSheet(e.css,this.dom)})),this.#i&&k.addStyleSheet(this.#i,this.dom),this.triggerEvent("on:root-styles"),this.triggerEvent("after:root-styles"))}getStyles(){return Promise.allSettled(this.#o.map((e=>e.whenCss))).then((()=>{let e=this.#o.reduce(((e,t)=>t.css?e+t.css:e),"");return[this.#n,e,this.#i].join("\n")}))}#c(...e){this.#r.length&&(this.#t.error(...e),this.#r.forEach((e=>this.#t.warn(e.name.toString(),e.error.toString()))),this.#r=[])}remove(){this.triggerEvent("before:root-remove",this),this.section&&(this.section.remove(),this.section=null),this.triggerEvent("on:root-remove",this),this.triggerEvent("after:root-remove",this)}}const C=k;var L=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),P=function(e,t,n,o,a,s){if(o){var l=[],c=S.resolve();e.debug("creating panel",o);var d=e.getId("panel-container-"+o);r(s)||(s={});var u=function(t){var n=document.createElement("iframe");return n.className="wy-panel-frame",n.id=e.getId("panel-"+o),n.name=e.getId("panel-"+o),n.allowFullscreen=1,n.dataset.weavyId=e.getId(),t&&(n.dataset.src=new URL(t,e.url).href),n},p=this;p.panelId=o,p.attributes=s,p.node=document.createElement("div"),p.node.className="wy-panel",s.className&&p.node.classList.add(s.className),p.node.id=d,p.node.dataset.id=o,s.title&&(p.node.dataset.title=s.title),p.frame=u(a),p.node.appendChild(p.frame),p.node.frame=p.frame,p.eventParent=n,p.on=e.events.on.bind(p),p.one=e.events.one.bind(p),p.off=e.events.off.bind(p),p.triggerEvent=e.events.triggerEvent.bind(p),p.frame.dataset.src&&(p.location=new URL(p.frame.dataset.src,e.url).href),s.type&&(p.node.dataset.type=s.type),void 0!==s.persistent&&(p.node.dataset.persistent=String(s.persistent)),void 0!==s.preload&&(p.node.dataset.preload=String(s.preload));try{e.debug("Appending panel",o),n.node.appendChild(p.node),t.set(o,p)}catch(t){e.error("Could not append panel",o)}var f=!1,h=!1,g=!1,y=!1;p.loadingStarted=function(e){e&&(g=!1),y=!0,m(p)},p.loadingFinished=function(){g=!0,y=!1,m(p)},p.on("panel-loading",(function(e,t){requestAnimationFrame((()=>{t.isLoading?p.node.classList.add("wy-loading"):p.node.classList.remove("wy-loading"),t.isLoaded?p.node.classList.add("wy-loaded"):p.node.classList.remove("wy-loaded")}))})),Object.defineProperty(p,"isOpen",{get:function(){return p.node.classList.contains("wy-open")}}),Object.defineProperty(p,"isLoading",{get:function(){return y}}),Object.defineProperty(p,"isRegistered",{get:function(){return f}}),Object.defineProperty(p,"isReady",{get:function(){return h}}),Object.defineProperty(p,"isLoaded",{get:function(){return g}}),p.whenReady=new S;var w=function(t,n){h=!0,p.triggerEvent("before:panel-ready",{panelId:o});var r=p.location,i=p.statusCode,a=!n.statusCode||200===n.statusCode;p.location=new URL(n.location,e.url).href,p.statusCode=n.statusCode,"string"==typeof n.title&&n.title&&(p.node.dataset.title=n.title),p.loadingFinished(),i===n.statusCode||a||e.warn(n.location+" "+n.statusCode+" "+n.statusDescription);var s=r&&r!==p.location,l=i!==p.statusCode,c=p.location===p.frame.dataset.src&&!p.isOpen;p.isOpen&&(s||l)&&(s&&a&&!c?p.stateChangedAt=Date.now():a&&!c||(p.stateChangedAt=null),e.history.addState("replace")),p.triggerEvent("on:panel-ready",{panelId:o}),p.whenReady.resolve(p),p.triggerEvent("after:panel-ready",{panelId:o})},v=function(){p.triggerEvent("before:panel-unready",{panelId:o}),h=!1,p.loadingStarted(!0),p.whenReady.reset(),p.triggerEvent("on:panel-unready",{panelId:o}),p.triggerEvent("after:panel-unready",{panelId:o})};e.on(I,"ready",{weavyId:e.getId(),windowName:p.frame.name},w),e.on(I,"unready",{weavyId:e.getId(),windowName:p.frame.name},v);return p.whenLoaded=new S,e.on(I,"load",{weavyId:e.getId(),windowName:p.frame.name},(function(){p.whenLoaded.resolve(p)})),p.open=function(t,o){return e.whenReady().then((function(){if(e.log("openPanel",p.panelId+(t?" "+t:""),o?"no history":"with history"),!p.node.dataset.persistent&&!e.authentication.isAuthorized())return Promise.reject(new Error("Unauthorized, can't open panel "+p.panelId));var r=p.triggerEvent("panel-open",{panelId:p.panelId,destination:t,panels:n});return!1!==r&&r.panelId===p.panelId?(p.node.classList.add("wy-open"),window.requestAnimationFrame((()=>p.node.classList.add("wy-transition"))),p.load(r.destination,null,null,null,o)):Promise.reject(new Error("Prevented open "+p.panelId))}))},p.toggle=function(t){return e.whenReady().then((function(){e.info("toggling panel",p.panelId);var n=p.isOpen;return p.triggerEvent("panel-toggle",{panelId:p.panelId,closed:n}),n?p.close():p.open("string"==typeof t?t:null)}))},p.close=function(t,o){return e.whenReady().then((function(){if(p.isOpen){e.info("closePanel",p.panelId,!0===o?"no event":"",!0===t?"no history":""),c.reset();var r=[];p.node.classList.remove("wy-open","wy-transition"),!0!==o&&(p.triggerEvent("panel-close",{panelId:p.panelId,panels:n}),!0!==t&&(p.stateChangedAt=Date.now(),e.history.addState())),r.push(p.postMessage({name:"close"}).catch((()=>{e.warn("Unable to close panel",p.panelId)}))),r.push(e.whenTimeout(250)),Promise.all(r).then((()=>p.postMessage({name:"closed"}))).then((()=>{c.resolve()}))}return c()}))},p.load=function(t,n,r,i,a){return e.whenReady().then((function(){var s=p.frame;if(e.log("panel.load",t,i),t)t=new URL(t,e.url).href,p.location=t,p.isReady?(e.log("panel is ready load"),i&&p.loadingStarted(!0),p.postMessage({name:"turbo-visit",url:t,data:n,method:r,action:"replace"})):(e.log("panel not ready load"),p.loadingStarted(i),function(t,n,o,r){e.whenReady().then((function(){if(r=String(r||"get").toLowerCase(),t){var i=n;if("get"===r&&o&&(i=-1===i.indexOf("?")?i+"?"+o:i+"&"+o),t.src!==i){if(t.src=i,"get"===r)return void e.debug("sendToFrame using src")}else if(t.src&&"get"===r)return e.debug("sendToFrame using window.open"),void window.open(i,t.name);e.debug("sendToFrame using form");var a=document.createElement("form");a.action=n,a.method=r,a.target=t.name,o&&(o=o.replace(/\+/g,"%20")),(o&&o.split("&")||[]).forEach((function(e){var t=e.split("="),n=decodeURIComponent(t[0]),o=decodeURIComponent(t[1]),r=document.createElement("input");r.type="hidden",r.name=n,r.value=o,a.appendChild(r)})),e.nodes.container.appendChild(a),a.submit(),a.remove()}}))}(s,t,n,r));else if(p.isLoaded||p.isLoading){if(!p.isLoaded&&!p.isLoading)return Promise.resolve();p.postMessage({name:"show"})}else e.debug("panels:",o,"predefined loading"),p.loadingStarted(!0),s.setAttribute("src",s.dataset.src);return!0!==a&&(p.stateChangedAt=Date.now(),e.debug("panels: adding history state",o,p.location),e.history.addState()),p.whenLoaded()}))},p.preload=function(){var t=function(){p.isLoading||p.isLoaded||(e.debug("preloading panel:",o),p.load(null,null,null,null,!0))};return window.requestIdleCallback?window.requestIdleCallback(t):"complete"===document.readyState?t():e.one(document,"load",t),p.whenLoaded()},p.reload=function(){return e.whenReady().then((function(){p.isLoading=!0,p.postMessage({name:"reload"}),p.triggerEvent("panel-reload",{panelId:o})}))},p.reset=function(){return e.whenReady().then((function(){var t=p.frame;if(t){e.log("resetting panel",o);var n=u(t.dataset.src||t.src);f=!1,h=!1,g=!1,y=!1,p.location=null,p.statusCode=null,p.whenReady.reset(),p.whenLoaded.reset();var r=p.isOpen;try{I.unregisterContentWindow(t.name,e.getId())}catch(n){e.error("Could not unregister window id",t.name,n)}return p.node.removeChild(t),p.node.appendChild(n),p.frame=n,p.triggerEvent("panel-reset",{panelId:o}),r?p.load(null,null,null,null,!0):Promise.resolve()}return Promise.resolve()}))},p.getState=function(){return e.debug("getPanelState",o),e.history.getStateFromPanel(o)},p.setState=function(t){if(t&&t.panelId===o)if(new URL(t.location,e.url).origin===e.url.origin){if(t.title&&(p.node.dataset.title=t.title),!t.statusCode||200===t.statusCode){if(t.isOpen===p.isOpen&&t.location===p.location||(p.stateChangedAt=t.changedAt),t.isOpen){var n=t.location!==p.location?t.location:null;return p.isOpen?p.open(n,!0):p.open(t.location,!0)}return p.close(!0)}e.warn("setState: Invalid url http status.",o)}else e.warn("setState: Invalid url origin.",o,new URL(t.location,e.url).origin);else e.warn("setState: State not valid.",o)},e.on(I,"message",{weavyId:e.getId(),windowName:p.frame.name},((e,t)=>p.triggerEvent("message",i(t,{panelId:o})))),p.postMessage=function(t,n){return p.whenReady().then((function(){var o=p.frame;return o?o.isConnected?o&&I?I.postToFrame(o.name,e.getId(),t,n):Promise.reject():Promise.reject(new Error("Panel frame "+p.panelId+" is not connected to the DOM.")):Promise.reject(new Error("No valid panel frame for "+p.panelId+"."))}))},p.remove=function(r,i){var a=function(i){if(!p.node.dataset.persistent||r){if(p.isOpen)return p.id=e.getId("weavy-panel-removed-"+o),e.whenTimeout(0).then((function(){return p.close(i).then((function(){return p.remove(r,i)}))}));e.off(I,"ready",{weavyId:e.getId(),windowName:p.frame.name},w),e.off(I,"unready",{weavyId:e.getId(),windowName:p.frame.name},v);try{I.unregisterContentWindow(p.frame.name,e.getId())}catch(t){e.error("Could not unregister window id",p.frame.name,t)}return p.node.remove(),t.delete(o),n.triggerEvent("panel-removed",{panelId:o}),Promise.resolve()}};return r?a(i):e.whenReady().then((function(){return a(i)}))},e.on(I,"request:reset",{weavyId:e.getId(),windowName:p.frame.name},(function(){p.reset()})),e.on(I,"request:close",{weavyId:e.getId(),windowName:p.frame.name},(function(){p.close()})),p.node.appendChild(function(t,n){var o=document.createElement("div");if(o.className="wy-controls",n.controls&&(!0===n.controls||n.controls.close)){var r=document.createElement("div");r.className="wy-icon"+("string"==typeof n.controls.close?" "+n.controls.close:""),r.title="Close",r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>',e.on(r,"click",t.close.bind(t)),o.appendChild(r)}return o}.call(e,p,s)),n.triggerEvent("panel-added",{panel:p,panelId:o,url:a,attributes:s}),p}function m(t){t.isLoading?(!function(t){if(!t.isRegistered){try{I.registerContentWindow(t.frame.contentWindow.self,t.frame.name,e.getId(),e.url.origin)}catch(n){e.error("Could not register window id",t.frame.name,n)}f=!0}}(t),l[o]=e.whenTimeout(3e4),l[o].then((function(){y=!1,m(t)}))):l[o]&&(l[o].cancel(),delete l[o]),t.triggerEvent("panel-loading",{panelId:o,isLoading:t.isLoading,isLoaded:t.isLoaded})}e.error("new WeavyPanel() is missing panelId")},j=function(e){var t=new Map,n=new Map;function o(t){e.debug("closing panels");var o=[];return n.forEach((function(e){o.push(e.close(t))})),Promise.all(o)}function r(o){e.debug("clearing"+(o?" all":"")+" panels",n.size);var r=[];n.forEach((function(e){r.push(e.remove(o,!0))}));var i=Promise.all(r).then((function(){t.forEach((function(n,r){!function(n,o){n=n||"global";var r=t.get(n);if(o){try{r.node.remove()}catch(t){e.warn("Could not remove panels container")}t.delete(n),delete r.node,e.log("Panels container removed",n)}}(r,o)}))}));return i}function i(){e.debug("resetting panels");var t=[];return n.forEach((function(e){t.push(e.reset(!0))})),Promise.all(t)}function a(o){if(L)return Promise.resolve();var r=this;return"whenReady"in e?e.whenReady().then((function(){var i,s=(i=r instanceof HTMLElement&&r.dataset.containerId?t.get(r.dataset.containerId).panels:Array.from(n.values())).filter((function(e){return e.isLoading}));if(s.length)return Promise.all(s.map((function(e){return e.whenLoaded()}))).then((function(){return a.call(r,o)}));var l=i.filter((function(e){return!("true"!==e.node.dataset.preload&&"placeholder"!==e.node.dataset.preload||e.isLoading||e.isLoaded)}));if(l.length)return Promise.all(l.map((function(e){return e.preload()}))).then((function(){return a.call(r,o)}));if(o){var c=i.filter((function(e){return"false"!==e.node.dataset.preload&&!e.isLoading&&!e.isLoaded}));if(c.length)return c[0].preload().then((function(){return e.whenTimeout(1500).then((function(){return a.call(r,!0)}))}))}return e.debug("preload done"),Promise.resolve()})):Promise.resolve()}var s=function(){!1!==e.options.preload&&e.whenTimeout(5e3).then((function(){a()}))};e.on("load",s),e.on("clear-user signed-out",(function(){o(!0)})),e.on("after:clear-user after:signed-out",(function(){i()})),e.on("user-error",(function(){r()})),e.on("destroy",(function(t,n){e.off("load",s),n.whenAllDestroyed.push(r(!0))})),this.clearPanels=r,this.closePanels=o,this.createContainer=function(o){o=o||"global";var r=e.getId("panels-"+o),i={containerId:o},a=document.createElement("div");return a.id=r,a.className="wy-panels",a.dataset.containerId=o,i.node=a,i.addPanel=function(t,o,r){return new P(e,n,i,t,o,r)},i.on=e.events.on.bind(i),i.one=e.events.one.bind(i),i.off=e.events.off.bind(i),i.triggerEvent=e.events.triggerEvent.bind(i),t.set(o,i),i},this.getContainer=function(e){return t.get(e||"global")},this.getPanel=function(e){return n.get(e)},this.getCurrentPanels=function(){return Array.from(n.values())},this.preload=a,this.resetPanels=i};j.defaults={controls:{close:!1}};const O=j;const A=function(e){var t=this,n=new Map,o={modal:"wy-modal",preview:"wy-dark",overlay:"wy-floating"},r={preview:/^(.*)(\/attachments\/[0-9]+\/?)(.+)?$/,content:/^(.*)(\/content\/[0-9]+\/?)(.+)?$/};function a(){e.debug("sorting overlays",Array.from(n.values()).filter((e=>e.isOpen)).reverse()),Array.from(n.values()).filter((e=>e.isOpen)).reverse().forEach(((e,t)=>{e.node&&(e.node.style.transform="translateZ(-"+t+"rem)")}))}function s(t){if(e.log("overlay panels focus",t?.panelId,Array.from(n.values())),t=t||c())try{t.frame.contentWindow.focus()}catch(e){t.frame.focus()}}function l(e){e.isOpen?e.loadingStarted(!0):e.reset()}function c(){return Array.from(n.values()).filter((e=>e.isOpen)).pop()}function d(e){var t=c();if(t)return 27===e?(t.close(),!0):(t.postMessage({name:"key:trigger",which:e}),!0)}this.overlay=function(t){t=i(t),e.log("get overlay",t);let r=t.overlayId||t.type||"overlay",s=n.get(r);if(s)t.title?s.node.dataset.title=t.title:delete s.node.dataset.title;else{let i=new URL(t.url,e.url);t.type&&(t.className=o[t.type]+(t.className?" "+t.className:"")),s=e.nodes.panels.overlays.addPanel("overlay:"+r,i,t),s.on("before:panel-open",(function(){!function(t){var o=n.get(t);o&&(e.debug("preview panels moveToFront",t),n.delete(t),n.set(t,o),requestAnimationFrame(a))}(r)})),s.on("panel-ready root-styles",(()=>e.root.getStyles().then((e=>{s.postMessage({name:"styles",id:r,css:e,className:t.className})})))),n.set(r,s)}return s},e.on(I,"overlay-open",e.getId(),(function(n,o){var r=new URL(o.url,e.url).href;o.url=r,o.overlayId=o.overlayId||o.type||o.weavyMessageId||"overlay",e.log("overlay-open",o);var i,a=t.overlay(o,!0);a.location&&a.location!==o.url&&l(a),i=o.url,a.open(i).then(s)})),e.on("before:build",(function(){e.nodes.panels.overlays||(e.nodes.panels.overlays=e.panels.createContainer(),e.nodes.panels.overlays.node.classList.add("wy-overlays"),e.nodes.global.appendChild(e.nodes.panels.overlays.node))})),e.on("after:panel-close",(function(t,o){if(o.panels===e.nodes.panels.overlays){var r=o.panelId.split("overlay:")[1];n.get(r);e.log("overlay panel after:close",o.panelId,r),a(),s()}})),this.open=function(n){return e.whenLoaded().then((function(){var e=n.url,o=n.target||"overlay";"overlay"===o&&r.preview.test(e)&&(o="preview");var i=t.overlay({type:o,url:e});return n.source&&n.source!==i.frame.name&&l(i),i.open(e).then(s)}))},this.openState=function(n){return e.whenLoaded().then((function(){let e=i(n.attributes,{title:n.title});t.overlay(e).setState(n).then(s)}))},this.closeAll=function(t){return e.whenLoaded().then((function(){let e=Array.from(n.values()).map((e=>e.close(t)));return Promise.all(e)}))},e.on(I,"key:press",e.getId(),(function(t,n){e.log("bouncing key",n.which,c()?.panelId),d(n.which)})),e.on(document,"keyup",(function(e){d(e.which)&&e.stopImmediatePropagation()}))};const R=function(e){var t=this;function n(t){var n=new S;if(t.target)e.log("navigation: opening overlay "+t.url),e.overlays.open(t).then((e=>{n.resolve(e)}));else if(t.url){let o={url:new URL(t.url,e.url)};e.whenLoaded().then((function(){let r=e.apps.filter((function(e){return e.match(o)})).pop();r?(console.log("found matching navigation app by url"),e.overlays.closeAll(!0),r.open(t.url).then((function(e){n.resolve(e)}))):(e.info("navigation: requested app was not found"),n.reject())}))}else e.warn("navigation: no valid request"),n.reject();return n()}t.open=function(t){var o=r(t)&&t.url,i=!t.target&&("string"==typeof t&&t||o),a=String(i||o);if(a.includes("wvy:")){e.log("checking wvy: url");var s=a,l=new URL(a,e.url),c=l&&l.hash&&l.hash.replace(/^#/,"");return c&&c.startsWith("wvy:")&&(s=l.hash.replace(/^#/,"").split(",")),e.history.open(s)}return i?(e.log("open navigation url",a),n({url:a})):o?(e.log("open navigation request",t),n(t)):S.reject()},e.on(I,"navigation-open",e.getId(),(function(n){let o="string"==typeof n.data.route?{url:n.data.route}:n.data.route;e.log("navigation-open",o),o=e.triggerEvent("before:navigate",o),o.source=n.data.windowName,!1!==o&&(e.info("navigate: trying internal auto navigation"),t.open(o).catch((function(){o=e.triggerEvent("on:navigate",o),!1!==o&&e.triggerEvent("after:navigate",o)})))}))};const T=function(e){var t=this;function n(e,t){return t&&(t.forEach((function(t){var n=!1;e=e.map((function(e){var o=!e.weavyId&&!t.weavyId||e.weavyId===t.weavyId,r=e.panelId===t.panelId;return o&&r?(n=!0,t):e})),n||e.push(t)})),e.sort((function(e,t){var n=e.isOpen-t.isOpen,o=(e.changedAt||0)-(t.changedAt||0);return n||o}))),e}function o(){var n=t.getCurrentState();e.debug("history: set current state",n),t.setBrowserState(n,"replace")}t.openUri=function(e){var n=t.getStateFromUri(e);return n&&n.panels.length?t.openState(n):S.reject()},t.getStateFromUri=function(t){t=a(t);var n=[];return t.forEach((function(t){if("string"==typeof t&&0===t.indexOf("wvy://")){var o=/^wvy:\/\/([^@/]*)@?([^/]*)(.*)$/.exec(t);if(o&&o.length){var r=o[1],i=o[2],a="panel-"+r+"__"+(i||e.getId()),s=o[3];e.debug("history: parsed wvy url",i,r),n.push({id:a,panelId:r,isOpen:!0,location:s,statusCode:200,weavyId:i,weavyUri:t,changedAt:Date.now()})}}})),{panels:n}},t.getStateFromPanel=function(t){var n=e.panels.getPanel(t);if(n){var o=e.options.id&&e.getId(),r="wvy://"+(e.options.id?e.getId(t).replace("__","@"):t)+(n.location&&new URL(n.location,e.url).pathname||"");return{id:n.node.id,panelId:t,isOpen:n.isOpen,location:n.location,statusCode:n.statusCode,title:n.node.dataset.title,weavyId:o,weavyUri:r,changedAt:n.stateChangedAt,attributes:n.attributes}}e.warn("history: getStateFromPanel; Panel not found "+t)},t.getCurrentState=function(){return{panels:e.panels.getCurrentPanels().map((function(e){return e.getState()})).sort((function(e,t){var n=e.isOpen-t.isOpen,o=(e.changedAt||0)-(t.changedAt||0);return n||o}))}},t.getBrowserState=function(){return window.history.state&&window.history.state.weavy},t.setBrowserState=function(t,o,r){if(t){e.debug("history: "+(o||"setting")+" browser state");var i=window.history.state||{};i.weavy=i.weavy||{},i.weavy.panels=n(i.weavy.panels||[],t.panels),r=r&&String(r)||window.location.href;try{"replace"===o?window.history.replaceState(i,null,r):window.history.pushState(i,null,r)}catch(t){e.warn("history: Could not push history state.",t)}}},t.addState=function(o,r){r=r||t.getCurrentState();var i=window.history.state||{},a=i.weavy=i.weavy||{},s={state:r,action:o||"push",url:window.location.href,globalState:a};return!1!==(s=e.triggerEvent("before:history",s))&&(s.globalState.panels=n(s.globalState.panels||[],s.state.panels),!1!==(s=e.triggerEvent("on:history",s))&&(e.debug("history: "+s.action+" history state"),t.setBrowserState(s.state,s.action,s.url),e.triggerEvent("after:history",s))),s.state},t.openState=function(t){return t&&t&&t.panels&&Array.isArray(t.panels)?e.whenReady().then((function(){return e.debug("history: opening state"),e.overlays.closeAll(!0),Promise.all(t.panels.map((function(t){if(!t.weavyId&&!e.options.id||t.weavyId===e.getId()){if(!t.panelId.startsWith("overlay:")){var n=e.panels.getPanel(t.panelId);return n?(e.debug("history: setting panel state",t.panelId),n.setState(t)):S.resolve()}e.overlays.openState(t)}})))})):S.reject("Error opening state")},e.on(window,"popstate",(function(){var n=t.getBrowserState();n&&(e.debug("history: popstate",n),t.openState(n))})),e.whenInitialized().then((function(){var n=t.getBrowserState();n&&(e.debug("history: load state",n),t.openState(n)),e.whenLoaded().then(e.whenTimeout(1)).then(o)}))},M=new Map,z={method:"POST",mode:"cors",cache:"reload",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},redirect:"manual",referrerPolicy:"no-referrer-when-downgrade"};class U{constructor(e){var t=!1,n=new m("WeavyAuthentication");n.debug("Create new weavy authentication",e),(e=e&&String(e)||window.location.origin+"/")&&(e=/\/$/.test(e)?e.slice(0,-1):e);var o=new h(this);this.on=o.on,this.one=o.one,this.off=o.off;var r,i,a=null,s=null,l=new S,c=new S,d=!1,u=new S,p=!1;function g(e){return e?e.id&&-1!==e.id||!1:a&&a.id&&-1!==a.id||!1}var y=!1,w=new S;function v(e){n.debug("Configuring token factory"),r=null,i=e,y=!1,w.reset()}function b(e){if("pending"!==w.state()&&e&&(w.reset(),y=!1),!1===y)if(n.debug("Requesting new token"),y=!0,"function"==typeof i){var t=i(e);"function"==typeof t.then?t.then((function(e){"string"==typeof e&&e?(r=e,w.resolve(r)):w.reject("The async token factory should return a string token.")}),(function(e){w.reject("Failed to get token from the async token factory:",e)})):w.reject("The token factory is not an async function.")}else w.reject("The token factory should be an async function returning a string.");return w()}function I(){n.debug("clearing access token and token factory"),r=null,i=null,y=!1,w.reset()}function x(e,t){e&&e.id?(a&&e&&a.id!==e.id&&n.debug("setUser",e.id,t),a=e,s=!0,g(e)?c.resolve():("pending"!==c.state()&&c.reset(),p=!1,u.resolve()),l.resolve(e)):(a=null,s=!1,c.reset())}function E(e,t){var r="updated";e&&e.id?(s&&(g()?e&&-1===e.id?(n.info("signed-out"),r="signed-out"):e&&e.id!==a.id&&(n.info("changed-user"),r="changed-user"):e&&-1!==e.id&&(n.info("signed-in",t),r="signed-in")),x(e,t||"processUser()"),o.triggerEvent("user",{state:r,authorized:g(e),user:e})):(x(null,t||"processUser()"),o.triggerEvent("clear-user"),o.triggerEvent("user",{state:"user-error",authorized:!1,user:e})),d=!1}function k(t){if(!d){d=!0,n.debug("checkUserState"+(void 0!==i?":token":":cookie"),t),"pending"!==l.state()&&l.reset(),"pending"!==c.state()&&c.reset();var o=new URL("/dropin/client/user",e),r=Object.assign({},z);b().then((function(e){if("string"!=typeof e)return Promise.reject(new Error("Provided access token is invalid."));r.body=JSON.stringify({access_token:e}),window.fetch(o.toString(),r).then((function(e){return 401===e.status&&void 0!==i?(n.warn("access token validation failed, trying again"),b(!0).then((function(e){return r.body=JSON.stringify({access_token:e}),window.fetch(o.toString(),r)}))):e})).then(f).then((function(e){n.debug("checkUserState fetch -> processing user"),E(e,"checkUserState,"+t)}),(function(){n.warn("checkUserState request fail"),n.debug("checkUserState fetch fail -> processing user"),E({id:null},"checkUserState,"+t)}))}))}return l()}function C(){var t=new S,r=new URL("/dropin/client/login",e);if(p)return u.then((function(){return C()}));"pending"!==u.state()&&u.reset(),n.debug("validating access token"),o.triggerEvent("signing-in");var i=Object.assign({},z);return b().then((function(e){return e&&"string"==typeof e?(i.headers.Authorization="Bearer "+e,window.fetch(r.toString(),i).then((function(e){return 401===e.status?(n.warn("access token validation failed, trying again"),b(!0).then((function(e){return i.headers.Authorization="Bearer "+e,window.fetch(r.toString(),i)}))):e})).then(f).then((function(e){return E(e),t.resolve(e)})).catch((function(e){n.error("sign in with access token failed.",e.message),o.triggerEvent("authentication-error",{method:"access_token",status:401,message:e.message}),E({id:null})}))):Promise.reject(new Error("Provided access token is invalid."))}))}this.init=function(e){return(null===s||e&&e!==i)&&("function"==typeof e&&v(e),void 0!==i?(n.debug("authenticate using token factory"),C()):k("init()")),t||(t=!0,n.debug("initialized")),l()},this.isAuthorized=g,this.isAuthenticated=function(){return!0===s},this.isInitialized=function(){return!0===t},this.isProvided=function(){return!!i},this.whenAuthenticated=function(){return l()},this.whenAuthorized=function(){return c()},this.signIn=function(){return"pending"!==l.state()&&l.reset(),"pending"!==c.state()&&c.reset(),C(),l()},this.signOut=function(t){var r=new URL("/dropin/client/logout",e);return p=!0,t&&I(),o.triggerEvent("clear-user"),window.fetch(r.toString(),z).catch((function(){n.warn("signOut request fail")})).finally((function(){n.debug("signout ajax -> processing user"),E({id:-1},"signOut()")})),u()},this.setTokenFactory=v,this.getAccessToken=b,this.clearTokenFactory=I,this.checkUserState=k,this.user=function(){return a},this.destroy=function(){s=null,a=null,I(),o.clear(),t=!1}}}const F=class{static getAuthentication(e){var t=!1,n=(e=e&&String(e))&&/^(https?:\/(\/[^/]+)+)\/?$/.exec(e);if(n&&(t=window.location.origin===n[1],e=n[1]),e=(t?"":e)||"",M.has(e))return M.get(e);var o=new U(e);return M.set(e,o),o}static removeAuthentication(e){e=e&&String(e)||"";try{var t=M.get(e);t&&t.destroy&&t.destroy(),M.delete(e)}catch(t){console.error("Could not remove authentication",e,t)}}};var N=function(e,t,n){e.debug("new WeavyApp",t);var o=this;o.container=null,o.root=null,o.panel=null,o.url=null,o.uid=null,o.name=null,o.type=null,o.autoOpen=null,o.weavy=e,o.options=t,o.data=n,o.eventParent=e,o.on=e.events.on.bind(o),o.one=e.events.one.bind(o),o.off=e.events.off.bind(o),o.triggerEvent=function(t,n){return n=i(n,{app:o}),e.events.triggerEvent.call(o,t,n)},Object.defineProperty(this,"isOpen",{get:function(){return!!o.panel&&o.panel.isOpen}}),o.isInitialized=!1,o.isBuilt=!1,Object.defineProperty(this,"isLoaded",{get:function(){return!!o.panel&&o.panel.isReady}}),o.whenInitialized=new S,o.whenBuilt=new S,o.whenLoaded=new S,o.configure=function(t,n){t&&"object"==typeof t&&(o.options=i(o.options,t,!0)),n&&"object"==typeof n&&(o.data=n),o.options&&"object"==typeof o.options&&(null!==o.autoOpen&&null!==o.container||(o.autoOpen=o.options&&void 0!==o.options.open?o.options.open:!o.group||!1,o.container=o.options.container),null===o.uid&&o.options.uid&&(o.uid=o.options.uid),null===o.name&&o.options.name&&(o.name=o.options.name),null===o.type&&o.options.type&&(o.type=o.options.type)),o.data&&"object"==typeof o.data&&(!o.uid&&o.data.uid&&(o.uid=o.data.uid),null===o.url&&o.data.url&&(o.url=new URL(o.data.url,e.url)),o.isInitialized=!0,o.triggerEvent("app-init"),o.whenInitialized.resolve(o),!o.isBuilt&&o.weavy.isBuilt&&o.build())},o.fetchOrCreate=function(t){if(t&&"object"==typeof t&&(o.options=t),o.options&&"object"==typeof o.options){var n=new URL("/dropin/client/app",e.url);e.fetch(n,o.options,"POST").then((function(e){o.data=e,o.configure.call(o)})).catch((function(e){o.weavy.error("WeavyApp.fetchOrCreate()",e.message),o.whenInitialized.reject(e)}))}else o.whenInitialized.reject(new Error("WeavyApp.fetchOrCreate() requires options"));return o.whenInitialized()},o.build=function(){return e.authentication.whenAuthorized().then((function(){var n=o.uid||o.type;if(o.options&&o.data){let l="app-root-"+(o.options.group||n);var r=o.root??=e.getRoot(l);if(!r&&o.container)try{o.root=r=e.createRoot(o.container,l,o),r.apps=new Set,r.container.panels=e.panels.createContainer("app-container-"+n),r.container.panels.eventParent=o,r.container.appendChild(r.container.panels.node)}catch(t){e.warn("could not create app in container:",n,t)}if(!o.isBuilt&&r){o.isBuilt=!0,e.debug("Building app",n);var a="app-"+n,s=!(!o.options||void 0===o.options.controls)&&o.options.controls;let l=o.root.addStyles(o.options);o.panel=r.container.panels.addPanel(a,o.url,{controls:s}),r.apps.add(o),o.panel.on("panel-open",((e,t)=>o.triggerEvent("app-open",t))),o.panel.on("panel-toggle",((e,t)=>o.triggerEvent("app-toggle",t))),o.panel.on("panel-close",((e,t)=>o.triggerEvent("app-close",t))),o.on("before:message",((e,t)=>{if(t.panelId===a)return i(t,{app:o})})),o.panel.whenReady().then((()=>{o.triggerEvent("app-load"),o.whenLoaded.resolve(o)})),o.on("panel-ready root-styles",(()=>o.root.getStyles().then((e=>{o.postMessage({name:"styles",id:o.uid,css:e,className:t.className})})))),l.then((e=>{o.triggerEvent("app-build"),o.whenBuilt.resolve(o)}))}}})),o.whenBuilt()},e.on("build",o.build.bind(o)),o.whenBuilt().then((function(){e.whenReady().then((function(){o.autoOpen&&!o.isOpen&&o.open.call(o,null,!0)}))})),e.on("after:signed-in",(function(){e.whenReady().then((function(){o.autoOpen&&!o.isOpen&&o.open.call(o,null,!0)}))})),o.configure()};N.prototype.open=function(e,t){var n=this,o=n.weavy;return Promise.all([n.whenBuilt(),o.whenInitialized()]).then((function(){var r=[n.panel.open(e,t)];let i=Array.from(n.root&&n.root.apps||[]);return i.length>1&&i.forEach((function(e){e!==n&&r.push(e.panel.close(!0))})),Promise.all(r).catch((function(e){o.warn("Could not open app",n.uid,e)}))}),(function(e){o.warn("Could not open app",n.uid,e)}))},N.prototype.close=function(){var e=this;return e.autoOpen=!1,e.whenBuilt().then((function(){return e.panel.close()}))},N.prototype.toggle=function(e){var t=this,n=t.weavy;return t.whenBuilt().then((function(){var o=[t.panel.toggle(e)];let r=Array.from(t.root&&t.root.apps||[]);return!t.isOpen&&r.length>1&&r.forEach((function(e){e!==t&&o.push(e.panel.close(!0,!0))})),Promise.all(o).catch((function(e){n.warn("Could not toggle app",t.uid,e)}))}))},N.prototype.reset=function(){var e=this,t=e.weavy;return Promise.all([e.whenBuilt(),t.whenReady()]).then((function(){return e.panel.reset()}))},N.prototype.remove=function(){var e=this,t=this.weavy;t.debug("Removing app",e.uid);var n=(e.panel?e.panel.remove(null,!0):Promise.resolve()).then((function(){if("getRoot"in t){let o="app-root-"+(e.options.group||e.uid||e.type);var n=t.getRoot(o);n&&0===n.apps.size&&n.remove()}}));return e.root.apps.delete(e),t.apps=t.apps.filter((function(t){return!t.match(e)})),n},N.prototype.postMessage=function(e,t){var n=this;return n.whenBuilt().then((function(){return n.panel.postMessage(e,t)}))},N.prototype.addStyles=function(e){var t,n;return"string"==typeof e?t=e:r(e)&&(t=e.css,n=e.stylesheet),this.whenBuilt.then((()=>this.root.addStyles({css:t,stylesheet:n})))},N.prototype.match=function(e){if(e){if(e.uid&&this.uid)return l(e.uid,this.uid);if(e.type&&this.type&&!this.uid)return l(e.type,this.type);if(e.url&&this.url){let t=new URL(e.url),n=new URL(this.url),o=t.href===n.href;n.pathname.endsWith("/")||(n.pathname+="/");let r=t.href.startsWith(n.href);return o||r}}return!1},N.getAppSelector=e=>{var t=r(e)&&e.uid,n=r(e)&&!e.uid&&e.type;return{isUid:t,isType:n,selector:(t||n)&&e}},N.select=(e,t,n)=>{var o,r=N.getAppSelector(n);if(r.selector){try{o=t.filter((function(e){return e.match(r.selector)})).pop()}catch(e){}o||(r.isUid||r.isType?(o=new N(e,n),t.push(o),Promise.all([e.authentication.whenAuthorized(),e.whenInitialized()]).then((function(){o.fetchOrCreate()})).catch((function(t){e.warn("Could not fetchOrCreate app",t||"")}))):e.warn("App "+JSON.stringify(r.selector)+" is not defined properly."))}return o};const B=N;console.info("weavy.js");const W="/dropin/client/init",q=/(?<major>\d+)\.(?<minor>\d+)\.(?<patch>\d+)(?:[-](?<prerelease>[^+]+))?(?:[+](?<build>\S+))?/;var D=[],H=function(){var t=this;for(var n in t.options=i(H.defaults),arguments)arguments[n]&&"object"==typeof arguments[n]&&(t.options=i(t.options,arguments[n],!0));function o(t){return t="wy-"+(t?t.replace(new RegExp("^wy-"),""):e()+e()),-1!==D.indexOf(t)&&(t=o(t+e())),t}var l,c=o(t.options.id);Object.defineProperty(t,"id",{get:function(){return c}}),D.push(t.id),t.console=new m(this,t.options.logging),t.log=t.console.log,t.debug=t.console.debug,t.warn=t.console.warn,t.error=t.console.error,t.info=t.console.info,t.getId=function(e){return e?t.removeId(e)+"__"+t.id:t.id},t.removeId=function(e){return e?String(e).replace(new RegExp("__"+t.getId()+"$"),""):e},Object.defineProperty(t,"version",{get:function(){return H.version},configurable:!1}),t.version&&t.log(t.version);try{if(!t.options.url||"/"===t.options.url||!new URL(t.options.url))throw new Error;l=t.options.url,"enforce"===t.options.https?l=l.replace(/^http:/,"https:"):"adaptive"===t.options.https&&(l=l.replace(/^http:/,window.location.protocol))}catch(e){return void t.error('Required url not specified.\nnew Weavy({ url: "https://mytestsite.weavycloud.com/" })')}Object.defineProperty(t,"url",{get:function(){return new URL(l)}}),t.user=null,t.data=null,t.isInitialized=!1,t.isBlocked=!1,t.isBuilt=!1,t.isLoading=!1,t.isLoaded=!1,t.events=new h(t),t.on=t.events.on,t.one=t.events.one,t.off=t.events.off,t.triggerEvent=t.events.triggerEvent,t.authentication=F.getAuthentication(t.url),void 0!==t.options.tokenFactory||t.authentication.isProvided()||t.error("specify an async token factory in your options"),t.authentication.isProvided()&&t.authentication.isInitialized()||t.authentication.init(t.options.tokenFactory),t.on(t.authentication,"user",(function(e,n){t.user=n.user,/^signed-in|signed-out|changed-user|user-error$/.test(n.state)&&(t.isLoading||(t.isLoaded&&t.whenLoaded.reset(),t.isLoaded=!1,t.data=null),"changed-user"===n.state?(t.triggerEvent("signed-out",{id:-1}),t.triggerEvent("signed-in",n)):t.triggerEvent(n.state,n),v())})),t.on(t.authentication,"signing-in",(function(){t.triggerEvent("signing-in")})),t.on(t.authentication,"clear-user",(function(){t.triggerEvent("clear-user")})),t.on(t.authentication,"authentication-error",(function(e,n){t.triggerEvent("authentication-error",n)})),t.nodes={},t.nodes.container=null,t.nodes.global=null,t.nodes.panels={},t.panels=new O(t),t.overlays=new A(t),t.apps=new Array,t.app=B.select.bind(this,t,t.apps);var p=[];function g(){p.forEach(clearTimeout),p=[]}function y(){var e=t.apps.reduce((function(e,t){return e&&t.isInitialized}),!0);return e}function w(){if(y())return S.resolve();var e=t.apps.reduce((function(e,t){return e.push(t.whenInitialized()),e}),[]);return Promise.all(e).then(w)}function v(){var e=new S;if(!t.isLoading){t.isLoaded&&t.whenLoaded.reset(),t.isLoaded=!1,t.isLoading=!0,t.options.href=window.location.href;var n=new URL(W,t.url).href,o={plugins:t.options.plugins,version:t.version};t.options.lang&&(o.lang=t.options.lang),t.options.tz&&(o.tz=t.options.tz),t.options.theme&&(o.theme=t.options.theme),t.fetch(n,o,"POST",null,!0).then((function(n){t.triggerEvent("client-data",n),e.resolve()}))}return e()}t.whenTimeout=function(e){var t,n=new S,o=function(){var e=p.indexOf(t);e>=0&&p.splice(e,1)};return p.push(t=setTimeout((function(){n.resolve()}),e)),n.then(o),n.catch((function(){return o(),clearTimeout(t),Promise.reject(new Error("Timeout cancelled"))})),n.cancel=function(){o(),clearTimeout(t)},n},t.whenReady=new S,t.whenInitialized=new S,t.whenBuilt=new S,t.whenLoaded=new S,t.on("init",(function(){t.options.apps&&(t.warn("Defining apps in weavy instance options is deprecated. Use weavy.app({ ...appOptions }) instead."),a(t.options.apps).forEach((function(e){t.app(e)})));v().then((function(){E.call(t).then((function(){t.whenReady.resolve()})),t.on("message",{name:"authenticate"},(()=>t.authentication.checkUserState("postal:authenticate")))}))})),t.on("after:init",(function(){t.isInitialized=!0,t.whenInitialized.resolve()})),t.init=function(e){return t.options=i(t.options,e),t.triggerEvent("init"),t.whenInitialized()},t.on("client-data",(function(e,n){if(t.data=n,t.isLoading=!1,!n)return t.error("Error loading client data"),void t.whenLoaded.reject();let o=q.exec(t.version),r=q.exec(t.data.version);if(o&&r&&(delete o.groups.build,delete r.groups.build,!d(o.groups,r.groups,!0))){let e="Weavy client/server version mismatch! \nclient: "+t.version+" \nserver: "+t.data.version,n=o.groups.major===r.groups.major,i=o.groups.minor===r.groups.minor;n&&i?t.warn(e):t.error(e)}!1===t.isBuilt&&(x.call(t),t.triggerEvent("build",{container:t.nodes.container,global:t.nodes.global}),t.isBuilt=!0,t.whenBuilt.resolve()),Promise.all([w(),t.whenReady()]).then((function(){t.triggerEvent("load"),t.isLoaded=!0,t.whenLoaded.resolve()}))}));var b=new Map;function x(){if(!t.getRoot()){var e=s(t.options.container)||document.documentElement,n=t.root=t.createRoot.call(t,e);t.nodes.container=n.root,t.nodes.global=n.container,t.nodes.global.classList.add("wy-viewport")}}function E(){var e,n,o=new URL("/dropin/client/ping",t.url),r="hasStorageAccess"in document,i=new S,a=new S,l=new S,c=new S,d=t.whenTimeout(3e3);if(!t.nodes.statusFrame){t.log("Frame Check: Started...");var u=t.nodes.statusFrame=document.createElement("iframe");u.className="wy-status-check",u.hidden=!0,u.id=t.getId("status-check"),u.setAttribute("name",t.getId("status-check"));return t.on(I,"user-status",{weavyId:t.getId(),windowName:t.getId("status-check")},(function(o,l){var c=parseInt(l.id)===parseInt(t.authentication.user().id);t.debug("Frame Check: user-status received",c),i.resolve(c),c?a.resolve():r?function(){d.cancel();var o,r=s("<span>Third party cookies are required to use this page. </span>"),i=s('<button class="wy-button wy-button-primary" style="pointer-events: auto;">Enable cookies</button>');i.onclick=function(){t.log("Frame Check: Opening storage access request"),o=window.open(new URL("/dropin/client/cookie-access",t.url),t.getId("storage-access")),I.registerContentWindow(o,t.getId("storage-access"),t.getId(),t.url.origin)},r.appendChild(i),n=t.alert(r,!0),t.one(I,"storage-access-granted",{weavyId:!0,domain:t.url.origin},(function(){t.log("Frame Check: Storage access was granted, authenticating and reloading status check."),e&&(e.remove(),e=null),n&&(n.remove(),n=null);let o=t.getId();t.authentication.signIn().then((function(){t.debug("Frame Check: reloading status check"),I.postToFrame(t.getId("status-check"),o,{name:"reload"})}))}))}():r||(e=t.alert("Allow third party cookies to use this page."))})),t.one(I,"ready",{weavyId:t.getId(),windowName:t.getId("status-check")},(function(){t.debug("Frame Check: frame ready"),c.resolve()})),d.then((function(){t.fetch(o).then((function(e){if(t.warn("Status check timeout. Please make sure your web server is properly configured."),!e.ok)return Promise.reject(new Error("Error fetching status url: "+e.statusText));if(e.headers.has("X-Frame-Options")){let t=e.headers.get("X-Frame-Options");if("DENY"===t||"SAMEORIGIN"===t&&o.origin!==window.location.origin)return Promise.reject(new Error("Frames are blocked by header X-Frame-Options"))}if(e.headers.has("Content-Security-Policy")){let n=e.headers.get("Content-Security-Policy").split(";").filter((function(e){return 0===e.indexOf("frame-ancestors")})).pop();if(n){let e=n.split(" ");if(e.splice(0,1),!e.filter((function(e){return"'self'"===e&&t.url.origin===window.location.origin||(e.indexOf("*")?window.location.origin.endsWith(e.split("*").pop()):e===window.location.origin)})).length)return Promise.reject(new Error("Frames blocked by header Content-Security-Policy: frame-ancestors"))}}})).catch((function(e){t.error("Frame status error detected: "+e.message)}))})),t.nodes.container.appendChild(t.nodes.statusFrame),t.whenTimeout(1).then((function(){t.nodes.statusFrame.src=o.href,t.isBlocked=!0;try{I.registerContentWindow(t.nodes.statusFrame.contentWindow,t.getId("status-check"),t.getId(),t.url.origin)}catch(e){t.warn("Frame postMessage is blocked",e),t.triggerEvent("frame-check",{blocked:!0})}})),Promise.all([c(),a()]).then((function(){return t.log("Frame Check:","OK"),t.isBlocked=!1,d.cancel(),e&&(e.remove(),e=null),n&&(n.remove(),n=null),t.triggerEvent("frame-check",{blocked:!1}),l.resolve({blocked:!1}),l()})).catch((function(e){return t.triggerEvent("frame-check",{blocked:!0}),l.reject(new Error("Frame check failed: "+e.message)),l()}))}}t.getRoot=function(e){return b.get(t.getId(e))},t.createRoot=function(e,n,o){var r=t.getId(n),i=s(e);if(i){if(b.has(r))return t.warn("Root already created",r),b.get(r);var a=new C(t,i,r,o);return a.on("root-remove",(()=>b.delete(r))),b.set(r,a),a}t.error("No parent container defined for createRoot",r)},t.fetch=function(e,n,o,r){e=new URL(e,t.url),o=o||"GET",n=n&&"string"==typeof n&&n||"GET"!==o&&n&&JSON.stringify(n,u)||n||"";var a=!("GET"===o&&!n);if(!(e.origin===t.url.origin))return Promise.reject(new Error("weavy.fetch: Only requests to the weavy server are allowed."));if(r=i({method:o,mode:"cors",cache:a?"no-cache":"default",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},redirect:"manual",referrerPolicy:"no-referrer-when-downgrade"},r,!0),n&&"GET"!==o)r.body=n;else if(n){let t=new URLSearchParams(n);e.search=(e.search?e.search+"&":"")+t.toString()}return t.authentication.whenAuthenticated().then((function(){return t.authentication.getAccessToken().then((function(n){return"string"!=typeof n?Promise.reject(new Error("weavy.fetch: Provided access token is empty!")):(r.headers.Authorization="Bearer "+n,window.fetch(e.toString(),r).then((function(n){return 401===n.status||403===n.status?(t.warn("weavy.fetch: access token failed, trying again"),t.authentication.getAccessToken(!0).then((function(t){return r.headers.Authorization="Bearer "+t,window.fetch(e.toString(),r)}))):n})).then(f).catch((function(e){return t.error("weavy.fetch: request failed!",e.message),Promise.reject(e)})))}))}))},t.destroy=function(){var e=new S,n=[],o=t.triggerEvent("destroy",{whenAllDestroyed:[]});return!1!==o?Promise.all(o.whenAllDestroyed||[]).then((function(){t.log("destroy: Removing roots"),b.forEach((function(e){e.remove()})),t.log("destroy: clearing events"),t.events.clear(),g();try{I.unregisterAll(t.getId())}catch(e){t.warn("weavy.destroy: could not unregister postal content windows")}for(var o in D.splice(D.indexOf(t.getId()),1),t)Object.prototype.hasOwnProperty.call(t,o)&&delete t[o];Promise.all(n).then((function(){e.resolve()}))})).catch((function(){e.reject()})):e.reject(),e()},t.navigation=new R(t),t.history=new T(t),t.plugins={};var k={},L=[],P=[];function j(e){if(e){if(Object.prototype.hasOwnProperty.call(k,e)){var n=k[e];if(n.dependencies.length&&n.dependencies.forEach((function(n){"function"!=typeof H.plugins[n]?t.error("plugin dependency needed by "+e+" is not loaded/registered:",n):t.options.includePlugins&&!1!==t.options.plugins[n]||!t.options.includePlugins&&t.options.plugins[n]||t.error("plugin dependency needed by "+e+" is disabled:",n),-1===P.indexOf(n)?(P.push(n),j(n)):t.error("You have circular Weavy plugin dependencies:",e,n)})),Object.prototype.hasOwnProperty.call(k,e))return L.push(k[e]),delete k[e],P=[],!0}}else for(n in k)j(n);return!1}if(!1!==t.options.plugins){for(z in t.options.plugins=t.options.plugins||{},H.plugins)"function"==typeof H.plugins[z]?(t.options.includePlugins&&!1!==t.options.plugins[z]||!t.options.includePlugins&&t.options.plugins[z])&&(k[z]={name:z,dependencies:Array.isArray(H.plugins[z].dependencies)?H.plugins[z].dependencies:[]}):t.error("Registered plugin is not a plugin",z,typeof H.plugins[z]);for(var M in j(),L){var z=L[M].name;t.debug("Running Weavy plugin:",z),t.options.plugins[z]=i(H.plugins[z].defaults,r(t.options.plugins[z])?t.options.plugins[z]:{},!0),t.plugins[z]=new H.plugins[z](t,t.options.plugins[z])||!0}}!0===t.options.init&&t.init()};Object.defineProperty(H.prototype,"type",{get:()=>"Weavy"}),H.presets={noplugins:{includePlugins:!1},core:{includePlugins:!1,plugins:{alert:!0,filebrowser:!0,preview:!0,theme:!0}}},H.defaults={container:null,https:"adaptive",init:!0,includePlugins:!0,includeStyles:!0,plugins:{deeplinks:!1},preload:!0,shadowMode:"closed",url:"/"},H.plugins={},Object.defineProperty(H,"instances",{get:function(){return D.slice()},configurable:!1}),Object.defineProperty(H,"version",{get:function(){return"13.0.0"},configurable:!1});const _=H;class Z{constructor(e,t){var n=[];function o(t,n){n||(e.whenTimeout(5e3).then((function(){t.classList.remove("wy-in")})),e.whenTimeout(5200).then((function(){t.remove()}))),e.whenTimeout(1).then((function(){t.classList.add("wy-in")})),e.nodes.global.appendChild(t)}this.alert=e.alert=function(r,i){var a=document.createElement("div");return a.className=t.className,r instanceof HTMLElement?a.appendChild(r):a.innerHTML=r,e.nodes.global?o(a,i):n.push([a,i]),e.log("Alert\n"+a.innerText),a},e.on("after:build",(function(){n.forEach((function(t){o.apply(e,t)})),n=[]}))}}Z.defaults={className:"wy-alert-message wy-fade"},_.plugins.alert=Z;class ${constructor(e,t){const n=this;let o=new Map;this.getBadges=t=>"messenger"===t.type?e.fetch("dropin/client/conversation-badge/").then((e=>e.private+e.rooms)):Promise.reject(),this.get=e=>{n.getBadges(e).then((t=>{e.triggerEvent("badge",{count:t})})).catch((()=>{}))},e.whenLoaded().then((()=>{for(var r=0;r<e.apps.length;r++){let i=e.apps[r];i.options.badge&&(o.set(i,window.setInterval((()=>n.get(i)),t.pollingTime)),i.whenLoaded().then((()=>{clearInterval(o.get(i)),o.delete(i),n.get(i)})),n.get(i))}})),e.on("message",{name:"badge"},((e,t)=>{t.app&&t.app.options.badge&&t.app.triggerEvent("badge",{count:t.count})})),e.on("destroy clear-user signed-out",(function(){o.forEach((e=>window.clearInterval(e))),o.clear()}))}}$.defaults={pollingTime:6e4},_.plugins.badges=$;class X{constructor(e,t){if(e.on("history",(function(t,n){var o=e.options.plugins.deeplinks,r=n.globalState.panels.filter((function(e){return e.changedAt&&e.isOpen&&(!e.statusCode||200===e.statusCode)})),i=r.slice(-1),a=(o.multiple?r:i).map((function(e){return e.weavyUri}));return n.url=a.length?"#"+a.join(o.delimiter):n.url.split("#")[0],n})),!e.history.getBrowserState()&&window.location.hash){var n=window.location.hash.replace(/^#/,"").split(t.delimiter),o=e.history.getStateFromUri(n);o.panels.length&&(e.debug("deeplinks: setting initial state"),e.history.setBrowserState(o,"replace"))}}}X.defaults={multiple:!1,delimiter:","},X.dependencies=[],_.plugins.deeplinks=X;class G{constructor(e,t){var n=!1,o="https://filebrowser.weavycloud.com",r=o+"/index10.html",i="about:blank",a=null,s=new S,l=null;e.on(I,"addExternalBlobs",e.getId(),(function(e){I.postToSource(l,e.data)})),e.on(I,"file-browser-open",e.getId(),(function(t){l=t,function(){if(!n){n=!0,console.debug("Using filebrowser: ",r);var t=window.top.document.location.origin;if(i=r+"?origin="+t+"&v=X&t="+Date.now().toString()+"&weavyId="+e.getId(),!a||0===a.length){var l=e.getId("filebrowser");(a=document.createElement("iframe")).id=l,a.name=l,a.src=i,a.className="wy-filebrowser-frame",e.nodes.panels.filebrowser.node.appendChild(a),I.registerContentWindow(a.contentWindow,l,e.getId(),o)}a.addEventListener("load",(()=>{s.resolve()}),{once:!0})}return s.promise()}().then((()=>{a.style.display="block"}))})),e.on(I,"file-browser-close",e.getId(),(function(e){a.style.display="none"})),e.on("before:build",(function(){e.nodes.panels.filebrowser||(e.nodes.panels.filebrowser=e.panels.createContainer(),e.nodes.panels.filebrowser.node.classList.add("wy-filebrowser"),e.nodes.global.appendChild(e.nodes.panels.filebrowser.node))}))}}G.defaults={},_.plugins.filebrowser=G;class J{constructor(e,t){function n(t,n){var o;if(e.log("maximize",null!==t?t:"toggle",this.panelId),!1===t||this.maximized&&!0!==t){if(this.initialStyles){for(o in e.debug("restoring maximize styles"),this.initialStyles)Object.prototype.hasOwnProperty.call(this.initialStyles,o)&&(this.node.style[o]=this.initialStyles[o]);delete this.initialStyles}this.node.style.position=this.initialPosition,this.node.style.zIndex=this.initialZIndex,delete this.initialPosition,delete this.initialZIndex,this.maximized=!1}else{if(void 0===this.initialPosition&&(this.initialPosition=this.node.style.position),void 0===this.initialZIndex&&(this.initialZIndex=this.node.style.zIndex),this.node.style.position="fixed",this.node.style.zIndex=2147483647,n&&void 0===this.initialStyles){e.debug("setting maximize styles");var r={};for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=this.node.style[o],this.node.style[o]=n[o]);this.initialStyles=r}this.maximized=!0}}e.on("panel-added",(function(t,o){if(o.panel.maximize=n.bind(o.panel),o.attributes.controls&&(!0===o.attributes.controls||o.attributes.controls.maximize)){var r=o.attributes.controls.maximize,i=r&&"boolean"!=typeof r&&r;e.debug("maximize: adding panel control",o.panelId);var a=o.panel.node.querySelector(".wy-controls");a&&function(t,o,r){var i=document.createElement("div");i.className="wy-icon",i.title="Maximize",i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,4H20V20H4V4M6,8V18H18V8H6Z" /></svg>',e.on(i,"click",n.bind(o,null,r)),t.appendChild(i)}(a,o.panel,i)}}))}}J.defaults={},J.dependencies=[],_.plugins.maximize=J})(),o=o.default})()));